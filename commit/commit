#!/bin/sh
#
# $Id$
#
# The author disclaims all copyrights and releases this script into the
# public domain.
#
# Wrapper to commit changes back to CVS or Subversion.

# for CVS
commit_cvs () {
  cvs ci $CHANGESFILE $@
  exit $?
}

# for subversion
commit_svn () {
  svn ci $CHANGESFILE $@
  exit $?
}

# process arguments
OPT=
CHANGESFILE=
while getopts F: OPT; do
  case $OPT in
    F)
      CHANGESFILE=$OPTARG
      if [ ! -f "$CHANGESFILE" ]; then
        echo "error: change file not a file: $CHANGESFILE" >&2
	exit 1
      fi
      CHANGESFILE="-F $CHANGESFILE"
    ;;
  esac
done
shift $(($OPTIND - 1))

# figure out what to do
if [ -f CVS/Root ]; then
  commit_cvs $@
elif [ -f .svn/entries ]; then
  commit_svn $@
else
  echo "error: could not determine how to commit: dir=`pwd`" >&2
  exit 1
fi
